package com.cleevio.vexl.cryptography

import androidx.test.ext.junit.runners.AndroidJUnit4
import org.junit.Assert
import org.junit.Assert.assertEquals
import org.junit.Test
import org.junit.runner.RunWith

/**
 * Instrumented test, which will execute on an Android device.
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
@RunWith(AndroidJUnit4::class)
class AesCryptoInstrumentedTest {

	@Test
	fun testAes() {
		val password = "some password"
		val originalMessage = "some message"

		val encryptedMessage = AesCryptoLib.encrypt(password, originalMessage)
		Assert.assertNotEquals(originalMessage, encryptedMessage)

		val decryptedMessage = AesCryptoLib.decrypt(password, encryptedMessage)
		assertEquals(originalMessage, decryptedMessage)
	}

	@Test
	fun testAesRealDataTest() {

		val m1 = "bPUJFHY3CpmufNZIiF2GDu1IjVYMMHrKl338e46eMiadiL5LzzvSCG2/CS9dRjz2rLFDZRlRxzTxWTXRknfjxGWHIEE17Dx62E9frJ06j3AVBOj4YjYpr0aMY7XEdiJ/BpgEZlLsiKiOIDGwlL3AWTUdq0b2CpcuJhw6Bbmm5veVfG9dA/L28KQ0Liz9o/dRFsXooghpbkZXZ+qCF3i/vBX0NIls7QWpGZ1ynebgFBWbquE+voos5rlYC8UAf1E3FqUyY9oQR5xVZ9SkLpLTyPBA1fHnwYxWDvDZJ3V8undK2tszzAFw2ceJuEMm/lsL2vCbBENbIs8Yn32kTm2gigZk/tQsvwi3Xf/MGX/TFJppOlmGh9lsjgcq++V/Ew9xj5aUXASQKSUNCBI6Dmy2ZBe6gE24PtvYlwADj/1sw8S2gJSLYxBBB2kzd/7hz61SXRvdEHGNaIf2CpQSM/AUDj+zWui7AxMnvPnv3ctPlFMrvWhn0CSOPi4zC4FezGJi7HDgmu2yw5EGVF1ED2/I7szquacuWSEvSkndMoBv5PccgD+bJr2KGwmk86uibpVsKEhfAWghBTlfw+GWWaI9CJsRzGjjMbvyCezwM8Jpg8jsV0NT9YtNAzpx2fFGPq9GGn4dixyEGG4N4fLkLJdXd/vCBbReVoLdWTaG+9unLgcHxYaX7uDMpilJJ4SbmLl3AVD2UZy1OSsL8EkCI4zlIst/EqI4mDjPdx3pYTMx4LGZs3pRux5S/r11ehq+osX2uQ8v38WChhjSmuIrswHOGs3739h7Q8ZMzzwKU+xjbs1wb7WVb7EOUE+sY+nntxxTbtgiVH8g6yTVqggxZkMesYiSNKu4LhNarbJZaLrg786NKjQw2aLavwOxq4nLgMJQ4YbXUaXYO3VO0hW+nrdRIgtiv6B9CCJD8UHpRp3zBcc/aguETpi8QGb0OGFqsOjo50xHne+C/ySw3PHwt2mz4TTspvKS3kbFirObGHeYehsIPPx5MOYqdBjywSjXLzSAVlvTdSnwhJCWvuZwOramSXYjsH2A+LXjQkbQBmBP3JSzMGpruOePBO0V0TgEB4H3ikSfaT8Z47wnVcQnitkU2ncY86llmFDnZMrpVxi9ueAAkf8cZf3BsUQ/0XTNFGoP0civzSwdj7YMlU6U1fepBmVh2nobq9Jq97by7pTQtrU="
		val p1 = "i5bgE/NGpw/3NvFxQTQfwTDSEcmsYiN6EW45ahiGHaRUytXwght/tm0pzBrxEoi2B4vXuDK1lotrhLrR6ZAVO2YYLbCxME1AnUDzjzbjiDQLYn6FjG7WetSnKl0x5gS9G7K6fjz/oFN+9Jntayqko6sWP2HWjxF21fTmlzextOsPcLYmaSSRQK8HuQntqO6axGoaBvkDbOFscvqYZnjN+CjDOvgFp1Yonctq3oIKBcyEQ7ORGrnAtYYqi5hbKslJoPxNKJ7uP6R40fbKY5IyODHlgrM7xquXs729BK7YJoY4T5sT32uKLA7HTHcR8f1RQiNmRFsbwkO5i4rrBs/Xmg=="


		val m2 = "BcPCXwOIJ2qwBmoYOX/ws+NQbkYrKeKnwoTP/xoaY0DVNVppTgbKPkgokXK92E/8eoKL8noWJjISg003IfFFjh8oYvyZIMBswcuVQcmI+WNmhW4WQNdsTY/v/eCnHHpo6UA4658LDW79jVIWoJ1bO1Bk+6PmH1vODCiYty4jT+haquXbfIMOkM4m6PygG+a1N3bXbaOYCu96w2Zou8FXk092ghcVFuzg3+e/gD6PmQzr1GfEuBNszQvlje4mMrk4Ivy8mIQVgO5uMwU8VhPGG6TqGboEUrZtl/jk46cSJjHoQm/vlQwPJ3GYC0/VVCLTko3Alz0mP6oClAFWK4QRdjcuU1g1SnLTZiAgH7fVtiTdD2abRHmSeqvDoHA+W6y173K30Y/tF7p9qTs0k5q51iEY1MgVma1bEc32QObURV5VZNfnNIZhUvsavjsv25Y9xpZAZfWSi6qbXWuIc9CFXu+BkjBPw7LTVNAOlwlnEIdzqfGTzO1qlxSku6VDui8WUjpUh596CaMdAS8BI0j+QRDW4y0YHPS5m9rkpnXrM3jzF71g/QZETZVpu65z6d7N/Ik+e0WfFhzCNfZuyQuB3IJ2Gg96zLo572JYCVEMf2+RjN1lTvKQH3Agf/OFM+TTFWp56tfq+x1T8TTyNBctJa1775iMy0yvvlGxa6OrmNXZsbO+7mEDgNQmJuVG/W8tRZSzf4In7Mo31PXmBHx+P4QgbxE9DYuNdCOdFutxFBi8qSrj3wdCPZWZb4F7EHPt2g+eB1vhJlP1mNyPUMsDJB/EzORCavb1BSwzAp07R6SSGZ8wxXnR2P1D2SrIAToEROFmPtcpQPgj8Hu39Orfy6wSsfigih6Gtnt3bP5baVcXy2xHfjwTj6VYz9p8xVuOnm6R1SHHsXfBxGfYDH4OjB1ePPwPjL2/Ml3hAo7kLIx5VODT5c0R3wivw5THMkDMgzqwYij1NQ0fw6bQq062/+Z+xJREqqt71Z+c6NbkdTpxLd+DkHecF19hqQYICZABNV/TF7tjQJP2jo5rN0RurVg0rV/Y2F9GS3bU1mQqVsXrU/Q/PyR6NvalZYM7QHXeMcTCKNjC2mUns1XiOkf9TFzYcBLr+rxj43ZOyupKtxO5wSXcLyRnEQs70l9V1vT4t4VXUWW3MOtIT5OldhEGlsjNXuu8pHsoFkw/6Z+HHd0="
		val p2 = "viBbBejcLLBs47+1Tbcymnbv6lqmkO94MpCCzNOqcPlKIXciC253ksL97X42RCXYSRBkGtRPXPmxELTS4LzzMcgXYFFh4iozst4jDhxHDRoqUoUdVW1FUzO2+eCmH749I5CzRF11f0MdV/f79eE4LS9QaEB8YtCs5KLFbpGCErSwTOnAwnJOFtKAq7L8TCpoxyDEPixz0bWZciuSK0WF2HBsTpRsKsbiZSJXPaAl0Wdk0P0hJv3DLj4RxX1Em346E2KsQzhXJH90wEiOd5VguJrDboPeiZC/YRh92/ABHjoonOQwF/0K7fCwdemgckEY3M8mY2vIdYIP5+5JeLsywQ=="


		val m3 = "F2S0t1j8Omh+tEta815cvUpGBVUyxEYs/nBVAsFnrUXgJV8cN6Ajx30zi65TBnZu2nrOf+j3gtpP/UJeF+qwYvcJTKYrigzqD40LrZ9iK6Glu9dNg5+Lz4JHuDR8yJu0qJUnvaBv1jFJXW4rMr2XFOFKaNVKtvYyxAQKCIj1lEjB+pguk+OFL8Fvc3FD7QNG0ngTv74r02deWXynHuKYr+AJ4XdQF0nu5p5JRbvSehrsT2O4X8ehAZRcRCcWX20OpPyEdKncVar2HR00o4KjeorWcbOHrh3M2f/sRU+rUql8I1YMT0YJ+bH660zt8YosBPkj+zkuhQuUurlBlsjMRO9NWvKN+j8TsdiMVlVXf5IlavWK9gJoIpMEjAxwLq/jfesiF1UnhTOF7e+3xG2aBGl/j2Btbfd80VF0I8iDQl24whaGw/AwNZLZRpaVPiUtzWMyMu7/FBGE8w2v/q7/BLCTLDwNhDam6snRYi9CFkbGWEbWtwI+skRWaJQ2iHaLSX1pZq6Zr6p0clHNiiHgof61D4Q3b3t3QFqNG6tn6Peau7VeO0JdjeUTCIauAGQP/+mZEQAuRrfqDoIYN7b6AlCLLooBtC3sLS4TS9nc4myJ1tDIbamuZIhsD2RWMsPWOFDr+IZpF97ntuRDGj7kh/YKEH/njxgw8jTIoQzynYpJZVO7Tj0HTpb0BzIaCjRabxW6AS/m5YTlunOPUXO4Zp65U2YkxvOTVnhKvUDsJa7x677GevFRrdGH28XTOhEXCiNnjQtC4FUaQhHW02fiRI94WBCBR9HmY+ybLIitsQilYikyoXRHd3OpnWeyeHI8ojG+MgWXE7l2FDC+RubjXJorXRq2P5A4ID8fKRTFuI5MtBDL3zrWKsvnn6I0/8ODoATh3cvWGrjFqjuiLer+HJKmI+fZzzgt69AWEjsFb3JXdN0MuKGSTxBTFcr8FyD/9Ks5sKbtCKCHrw0J8oDH5wK8vHaFoGEEdbeW6FC7rHpCBuXZGVPBQ46w7XQnSKYf"
		val p3 = "C8uXi5grHsvlOoPO8em2N3Diyb3W74ns+IocqJCBfoCvnVZsjq/FpB1NFLqIlQvkDeSDNeYxWNRrcY2MwBocnljOdIl6bZVIxLZQorYM3n7tR8T2Wa613k8kaWLNt8769NIx69+V4QSceBn3pxqkB7UPJaaSWIDpZ043Efe2g6ZLnzddbBUpZWNAjiPz9MNYqxwhHXfjsyOOw6m8R3kfEAyCmAt9eETj8mvr3BdwFnHTPivnUtWECvsjzDKzf3va9Ng7ttAmZT+WTWGvMZyR6amljc/zzO9baIW8zIALfjc5XRD+Gj7QSwjSKY20RXIzLT7p8onzwmQ1Rhn/JVLU2A=="


		val m4 = "aIeKNMgrB46MnL6dhmkNyKM1miL3PsK6YZrAKwg1VJnhD3qIG8i47peIQq2lUBG3L63FUr//Kcr/uhpHmZKcm32adyk60PSeo5XuGfG6891oKCJcd8JcSB824bGNI0Vd20/3cIMQc+DGMZBOIgZMNZdASfifQkkV4QbsdOWWFGLcP2k8Vj78z6mmMbm11uUxspaCTHwW7PWjv+9UEtKvHPlnadkAM7iJ6xe7ouq9ds+z1kAiIlaCisfLBY9mS1mG5+luoe2vpm0y7nLN9QNh5cBiY+uflZsuZXCPjcLEmCQjNQxFl2zwK38lTYl0n2P/uKYASC+fpl7IO7axWx81eqblQwyQOvzFwL49wpwPtAkAAUvbeS4vEQsCI5lLq08KsgCMGjmrsxiwQStZw3Jh6aKWp7EiFdJiN7887CRGWnP0sd5f0F2d/6ZKzb3OXpp6IzIZVh8HsMrET0z6LKpUDG56eWlAP0iJ2HDf0WWDOxn+AZDxAh2uMRJjKkoa9vEtE1ozFiKxdVbbiN4lTO/1PgJFxDt9+YkD+5WjaOx7OLlGlfE2JqO9mhjSVB5WuNuGq7tEaf+HiWESsAP8JZEe6a3xv3Ar+nHiHaXX+n9NsGhEiBdiFM4o0TNLkPxyP1CHb+QMmcK5wmbj+nTAL/vFT8/agwhClcc+riuBf3amCIFrZHZMF3SycAjwwiL9yXxaiv3VGDr3V8HlP8EgJlwR+RKA/GhIn4eR63tOMZq2gNZbi76iN5fjopCsMAaJZJJzkPkR/JUY6OSIK7POL3k6O4U3Y5aCakmtKcQaHfAMi2GVRXAgea1JharZxFyq8BDRWccOlRHAgqMnAauKCIrQMzzza63aaFA/YNMu8rFmRu5KftTRHSJFVx5rGN9KxaDvVCLe6cqJRS+zDU4THqkdnhosE52LfDLyujjTBOu00tnDmWiDEGoTazzORQ163gCmkkk8rwik2fGkF7eqAk/ErLg+Ge3RUSzQMJkuRSkNxQHJA6gfXII2NBaydZMDBIub"
		val p4 = "E+c73LqGd27n/u7Vwwc2GMZi7t3NsnezpkTfRrqvPtGhPu3Q2q4gtG5N5JmrLFntODmGHe9xrm49bPhPaxMCKjKVBaFTwhOKmw7kuZQsmFdHM8r4IJQfsxE7fT9GQ+V9atUv465RDhOyLkpqhX0MzUmJuDFPJCLFz70EXJ8VGZYU4Pkga50n4Rauh8G6NkcTQAdGLVAejeHiKaRGBZxPe46vs+Kt6Lasm4H5s80i4OFUHeg2viKWD6CVP6JIiJA+guj+RNhnOJCWb1kgmN9zpBfy/w+7XbynwJgw2i7SDJrBqlvwEqv7sTiLl9fi9i6w73PVTQVwH9/wlDGt+HEIlQ=="

		val dec1 = AesCryptoLib.decrypt(p1, m1)
		val dec2 = AesCryptoLib.decrypt(p2, m2)
		val dec3 = AesCryptoLib.decrypt(p3, m3)
		val dec4 = AesCryptoLib.decrypt(p4, m4)

		val originalMessage = "{\"offerPublicKey\":\"LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUU0d0VBWUhLb1pJemowQ0FRWUZLNEVFQUNFRE9nQUVlcWo0OXVIMGQzb2FyVzJUUERtaVI2bHg1My8xZGVjZQpoaUtKc09sSlFHMEpqVlVlVlI3U1BqV2l6VXhwVHNoMFZuemovdjdMNHp3PQotLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0K\",\"location\":[\"{\\\"longitude\\\":\\\"15.8861672539468496978543043951503932476043701171875\\\",\\\"latitude\\\":\\\"48.98075300719246882863444625400006771087646484375\\\",\\\"city\\\":\\\"Grešlové Mýto\\\"}\"],\"offerDescription\":\"aaax2\",\"amountBottomLimit\":\"0.0\",\"amountTopLimit\":\"250000.0\",\"feeState\":\"WITHOUT_FEE\",\"feeAmount\":\"1.0\",\"locationState\":\"ONLINE\",\"paymentMethod\":[\"CASH\"],\"btcNetwork\":[\"LIGHTING\"],\"currency\":\"CZK\",\"offerType\":\"SELL\",\"activePriceState\":\"NONE\",\"activePriceValue\":\"0\",\"activePriceCurrency\":\"CZK\",\"active\":\"true\",\"groupUuids\":[]}"

		assertEquals(originalMessage, dec4)
	}
}